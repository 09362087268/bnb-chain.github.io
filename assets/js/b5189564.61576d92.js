"use strict";(self.webpackChunkbeta_BNB_Docs=self.webpackChunkbeta_BNB_Docs||[]).push([[8609],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>h});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=r.createContext({}),p=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},d=function(e){var n=p(e.components);return r.createElement(c.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},s=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),s=p(t),h=o,m=s["".concat(c,".").concat(h)]||s[h]||u[h]||a;return t?r.createElement(m,l(l({ref:n},d),{},{components:t})):r.createElement(m,l({ref:n},d))}));function h(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,l=new Array(a);l[0]=s;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i.mdxType="string"==typeof e?e:o,l[1]=i;for(var p=2;p<a;p++)l[p]=t[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}s.displayName="MDXCreateElement"},39531:(e,n,t)=>{t.r(n),t.d(n,{frontMatter:()=>a,contentTitle:()=>l,metadata:()=>i,toc:()=>c,default:()=>d});var r=t(87462),o=(t(67294),t(3905));const a={},l="Upgrade",i={unversionedId:"beaconchain/develop/node/upgrade",id:"beaconchain/develop/node/upgrade",isDocsHomePage:!1,title:"Upgrade",description:"Please follow Beacon Chain  Telegram Announcement Channel or forum to get the latest news about upcoming upgrades.",source:"@site/docs/beaconchain/develop/node/upgrade.md",sourceDirName:"beaconchain/develop/node",slug:"/beaconchain/develop/node/upgrade",permalink:"/docs/beaconchain/develop/node/upgrade",editUrl:"https://github.com/bnb-chain/bnb-chain.github.io/blob/master/docs/beaconchain/develop/node/upgrade.md",tags:[],version:"current",frontMatter:{},sidebar:"bscSideBar",previous:{title:"Types of Nodes",permalink:"/docs/beaconchain/develop/node/nodetypes"},next:{title:"Run a Local Testnet",permalink:"/docs/beaconchain/develop/node/localnetwork"}},c=[{value:"Upgrading Full Node",id:"upgrading-full-node",children:[],level:2},{value:"Forgot to Upgrade",id:"forgot-to-upgrade",children:[],level:2}],p={toc:c};function d(e){let{components:n,...t}=e;return(0,o.kt)("wrapper",(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"upgrade"},"Upgrade"),(0,o.kt)("p",null,"Please follow ",(0,o.kt)("a",{parentName:"p",href:"https://t.me/Binance_DEX_Announcement"},"Beacon Chain  Telegram Announcement Channel")," or forum to get the latest news about upcoming upgrades."),(0,o.kt)("h2",{id:"upgrading-full-node"},"Upgrading Full Node"),(0,o.kt)("p",null,"Many of Beacon Chain  upgrades are hardfork ones. If so, you have to finish the upgrade steps before the hardfork block height."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"If your node is already synced with the network, please download the new  binary and replace the previous version"),(0,o.kt)("li",{parentName:"ol"},"Replace the config.toml and app.toml under home folder with the latest versions. You can customize those parameters."),(0,o.kt)("li",{parentName:"ol"},"Stop the bnbchaind process and restart it with the new one.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"bnbchaind start --home <home-path>\n")),(0,o.kt)("h2",{id:"forgot-to-upgrade"},"Forgot to Upgrade"),(0,o.kt)("p",null,"The Beacon Chain  has a hardfork upgrade and if you failed to upgrade your fullnode to the latest version, ",(0,o.kt)("inlineCode",{parentName:"p"},"bnbchaind")," process will stop and even if you restart with the latest version, the following error will appear:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"panic: Tendermint state.AppHash does not match AppHash after replay. Got , expected 393887B67F69B19CAB5C48FB87B4966018ABA893FB3FFD241C0A94D2C8668DD2\ngoroutine 1 [running]:\ngithub.com/binance-chain/node/vendor/github.com/tendermint/tendermint/consensus.checkAppHash(0xa, 0x0, 0xc000bd8c56, 0x6, 0xc000b247c0, 0x12, 0x14e7bf9, 0x8592eb, 0xc000b247e0, 0x20, ...)\n/Users/huangsuyu/go/src/github.com/binance-chain/node/vendor/github.com/tendermint/tendermint/consensus/replay.go:464 +0x213\ngithub.com/binance-chain/node/vendor/github.com/tendermint/tendermint/consensus.(*Handshaker).ReplayBlocks(0xc000b37980, 0xa, 0x0, 0xc000bd8c56, 0x6, 0xc000b247c0, 0x12, 0x14e7bf9, 0x8592eb, 0xc000b247e0, ...)\n")),(0,o.kt)("p",null,"To recover from the ",(0,o.kt)("inlineCode",{parentName:"p"},"state")," conflict error, you need to:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Backup your home directory,  (default is ~/.bnbchaind)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Download the tool: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/bnb-chain/node/releases"},"state-recover"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Get the height of upgrade, this height will be announced in the upgrade announcement on the forum.  For example, if it's announced as 5000 in the forum and run the following command will make your full node recover to the last block before the upgrade, and that is 4999 :"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"./state_recover 4999 <your_home_path>\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Restart with the latest version of ",(0,o.kt)("inlineCode",{parentName:"li"},"bnbchaind"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"bnbchaind start &\n")))}d.isMDXComponent=!0}}]);